<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blog | Mujgan Aghazada</title>
  <link rel="icon" type="image/png" href="/favicon.png">

  <!-- 1) Set theme class ASAP -->
  <script>
    (function () {
      const saved = localStorage.getItem('theme');
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const theme = saved || (prefersDark ? 'dark' : 'light');
      document.documentElement.classList.add(theme === 'dark' ? 'dark-theme' : 'light-theme');
    })();
  </script>

  <!-- 2) Tailwind CDN with preflight disabled (avoid late resets) -->
  <script>
    window.tailwind = { config: { corePlugins: { preflight: false } } };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- 3) (Optional) Inter with minimal reflow -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=optional"
        onload="this.onload=null;this.rel='stylesheet'">
  <noscript>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=optional">
  </noscript>

  <!-- 4) Shared theme tokens + pill styles -->
  <link rel="stylesheet" href="/assets/theme.css">

  <style>
    /* Base stack + stabilizers */
    html, body {
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      font-size-adjust: 0.52;
      -webkit-text-size-adjust: 100%;
    }

    /* Page styles using theme tokens */
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-weight: 300;
      line-height: 1.75;
    }

    nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875rem;
      padding: 1rem 2rem;
      background-color: var(--bg-color);
    }
    nav .logo { font-weight: 500; color: var(--accent-color); }
    nav a {
      color: var(--text-color);
      margin-left: 1.5rem;
      text-decoration: none;
      transition: color 0.2s;
    }
    nav a:hover { color: var(--accent-color); }

    main { max-width: 64rem; margin: 0 auto; padding: 3rem 1.5rem; } /* ~ max-w-4xl px-6 py-12 */

    h1 {
      font-size: 1.75rem;
      font-weight: 500;
      margin-bottom: 2rem;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.25rem;
      color: var(--text-color);
      text-underline-offset: 4px;
      text-decoration-color: var(--border-color);
    }

    /* Post list styles (theme-aware) */
    .post {
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
      padding: 1.25rem 1rem;
      transition: background-color .2s ease;
    }
    .post:hover { background: var(--hover); }
    .post time {
      display: block;
      font-size: 0.875rem;
      color: var(--muted-color);
      margin-bottom: .5rem;
    }
    .post-title {
      display: inline-block;
      font-size: 1.125rem;
      font-weight: 500;
      color: var(--link-color);
      text-decoration: none;
      margin-bottom: .35rem;
    }
    .post-title:hover { text-decoration: underline; }
    .post-excerpt { margin: 0; color: var(--text-color); }

    /* Small helpers (replacing Tailwind utilities used in content) */
    .mb-8 { margin-bottom: 2rem; }
    .space-y-4 > * + * { margin-top: 1rem; }
  </style>
</head>
<body>
  <nav>
    <div class="logo">Mujgan Aghazada</div>
    <div>
      <a href="/">about</a>
      <a href="/projects/">projects</a>
      <a href="/photos/">film photos</a>
      <a href="/blog/">blog</a>
    </div>
  </nav>

  <main>
    <h1>blog</h1>
    <p class="mb-8" style="color: var(--muted-color);">word vomit!</p>

    <!-- Blog post list rendered dynamically -->
    <div id="blog-list" class="space-y-4"></div>
  </main>

  <script>
    // Fetch posts; if your posts.json lives at /blog/posts.json, this path is correct
    fetch('posts.json')
      .then(r => {
        if (!r.ok) throw new Error('Failed to load posts.json');
        return r.json();
      })
      .then(posts => {
        const container = document.getElementById('blog-list');

        // Sort newest first if you like (remove if your JSON is already ordered)
        posts.sort((a, b) => new Date(b.date || 0) - new Date(a.date || 0));

        posts.forEach(post => {
          // Expected keys: title, date (yyyy-mm-dd or readable), link, excerpt
          const link = post.link || '#';
          const title = post.title || 'Untitled';
          const dateISO = post.date || '';
          const dateText = post.date_text || post.date || '';
          const excerpt = post.excerpt || '';

          const el = document.createElement('article');
          el.className = 'post';

          el.innerHTML = `
            <time ${dateISO ? `datetime="${dateISO}"` : ''}>${dateText}</time>
            <a class="post-title" href="${link}">${title} →</a>
            ${excerpt ? `<p class="post-excerpt">${excerpt}</p>` : ''}
          `;

          container.appendChild(el);
        });
      })
      .catch(err => {
        const container = document.getElementById('blog-list');
        container.innerHTML = '<p style="color: var(--muted-color);">couldn’t load posts right now.</p>';
        console.error(err);
      });
  </script>

  <!-- Shared theme logic (injects the bottom-right toggle if missing) -->
  <script src="/assets/theme.js"></script>
</body>
</html>
